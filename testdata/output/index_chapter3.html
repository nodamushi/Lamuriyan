<!DOCTYPE html>
<html><head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">

<title>
第3章　　DOM操作
</title>

<meta content="noarchive,noindex,nofollow" name="robots">
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML" type="text/javascript">
 </script>
<link href="ntex.css" rel="stylesheet" type="text/css">

</head>
<body>
<div id="mainbody">
<header id="pagetitle">
<h1>
第3章　　DOM操作
</h1>
</header>



<p>L<span style="text-transform: uppercase; font-size: 70%;margin-left: -0.3em;vertical-align: 0.15em; line-height: 0;">a</span>muriyanでは内部データをDOMライクな中間オブジェクトを用いて表現し、最終的にコンバータでHTMLの仕様に準拠したDOM（<a href="http://nekohtml.sourceforge.net/">
CyberNeko HTML Parser</a>
,<a href="http://nekohtml.sourceforge.net/">
Xerces</a>
を利用）に変換しています。</p>
<p>L<span style="text-transform: uppercase; font-size: 70%;margin-left: -0.3em;vertical-align: 0.15em; line-height: 0;">a</span>muriyanの機関部である為、最初期から存在する概念ですが、<span style="color:red;">T<span style="text-transform:uppercase;margin-left:-0.1667em;vertical-align:-0.3em;line-height:0;margin-right:-0.115em;">e</span>XとHTMLに対する浅い理解で作っていたので、複雑なことしようとするとかなりカオスです</span>。後から後から追加したからね、仕方がないね。単純なことをしている限りは問題ない………と信じたいね！ユーザーの腕次第だね！</p>
<p>L<span style="text-transform: uppercase; font-size: 70%;margin-left: -0.3em;vertical-align: 0.15em; line-height: 0;">a</span>muriyan2を作るなら真っ先にここを改善したい。</p>
<nav>
<header>
<h1>目次</h1>
</header>
<ul>
<li>
<a class="ref" href="#__section:019">
<span class="itemnumber">3-1</span><span class="itemtitle">HTML DOMの作成</span></a>
<ul>
<li>
<a class="ref" href="#__section:020">
<span class="itemnumber">3-1.1</span><span class="itemtitle">ハイパーリンクの作成</span></a>
</li>
</ul>
</li>
<li>
<a class="ref" href="#__section:021">
<span class="itemnumber">3-2</span><span class="itemtitle">ノード操作</span></a>
<ul>
<li>
<a class="ref" href="#__section:022">
<span class="itemnumber">3-2.1</span><span class="itemtitle">&yen;block</span></a>
</li>
<li>
<a class="ref" href="#__section:023">
<span class="itemnumber">3-2.2</span><span class="itemtitle">&yen;inline</span></a>
</li>
<li>
<a class="ref" href="#__section:024">
<span class="itemnumber">3-2.3</span><span class="itemtitle">&yen;hbox</span></a>
</li>
<li>
<a class="ref" href="#__section:025">
<span class="itemnumber">3-2.4</span><span class="itemtitle">&yen;setAttr,&yen;setAttrs</span></a>
</li>
<li>
<a class="ref" href="#__section:026">
<span class="itemnumber">3-2.5</span><span class="itemtitle">&yen;nodevalue</span></a>
</li>
<li>
<a class="ref" href="#__section:027">
<span class="itemnumber">3-2.6</span><span class="itemtitle">&yen;setbox,&yen;box</span></a>
</li>
</ul>
</li>
<li>
<a class="ref" href="#__section:028">
<span class="itemnumber">3-3</span><span class="itemtitle">よりネイティブなノード操作</span></a>
<ul>
<li>
<a class="ref" href="#__section:029">
<span class="itemnumber">3-3.1</span><span class="itemtitle">&yen;createElement</span></a>
</li>
<li>
<a class="ref" href="#__section:030">
<span class="itemnumber">3-3.2</span><span class="itemtitle">ノードの保存と設定</span></a>
</li>
<li>
<a class="ref" href="#__section:031">
<span class="itemnumber">3-3.3</span><span class="itemtitle">ヒエラルキーの移動</span></a>
</li>
</ul>
</li>
</ul>
</nav>
<section class="sect" id="__section:019">
<header>
<h1><span class="secnumber">3-1章</span>HTML DOMの作成</h1>
</header>
<p>TODO</p>
<section class="ssect" id="__section:020">
<header>
<h1><span class="secnumber">3-1.1</span>ハイパーリンクの作成</h1>
</header>
<code class="nhlight nhlight-TeX">
<pre><ol start="1"><li class="oddline"><span class="linecontainer"><span class="command-token">\anchor</span><span class="text-token">[属性名=値,属性名=値………]</span><span class="block-token">{</span><span class="text-token">URL</span><span class="block-token">}</span><span class="block-token">{</span><span class="text-token">表示する文字</span><span class="block-token">}</span></span></li></ol></pre></code>
<p>で&lt;a&gt;によるハイパーリンクを作成できます。</p>
</section>
</section>
<section class="sect" id="__section:021">
<header>
<h1><span class="secnumber">3-2章</span>ノード操作</h1>
</header>
<p>TODO</p>
<section class="ssect" id="__section:022">
<header>
<h1><span class="secnumber">3-2.1</span>&yen;block</h1>
</header>
</section>
<section class="ssect" id="__section:023">
<header>
<h1><span class="secnumber">3-2.2</span>&yen;inline</h1>
</header>
</section>
<section class="ssect" id="__section:024">
<header>
<h1><span class="secnumber">3-2.3</span>&yen;hbox</h1>
</header>
<p>～の部分を引数として取らないノードの作成の為に一応定義しておきました。</p>
<code class="nhlight nhlight-TeX">
<pre><ol start="1"><li class="oddline"><span class="linecontainer"><span class="command-token">\hbox</span><span class="block-token">{</span><span class="keyword-token">\verb</span><span class="text-token">+引数じゃないので</span><span class="keyword-token">\verb</span><span class="text-token">が使えるよ！+</span><span class="block-token">}</span></span></li></ol></pre></code>
<p>hboxで作られるノードは特殊でDOMでいえば、DocumentFragmentにあたります。そのため、インラインやブロックかどうかの判定を放棄していますので、利用には注意してください。要するに、hboxを使えば、インライン要素として作ったエレメントに対してもブロック要素を突っ込めるというカオスが出来るわけです。カオスですね。後付けだから仕方がないね。</p>
</section>
<section class="ssect" id="__section:025">
<header>
<h1><span class="secnumber">3-2.4</span>&yen;setAttr,&yen;setAttrs</h1>
</header>
<p>ノードに対して属性を指定するだけですが………カオスです。とてもカオスです。</p>
</section>
<section class="ssect" id="__section:026">
<header>
<h1><span class="secnumber">3-2.5</span>&yen;nodevalue</h1>
</header>
</section>
<section class="ssect" id="__section:027">
<header>
<h1><span class="secnumber">3-2.6</span>&yen;setbox,&yen;box</h1>
</header>
</section>
</section>
<section class="sect" id="__section:028">
<header>
<h1><span class="secnumber">3-3章</span>よりネイティブなノード操作</h1>
</header>
<p>L<span style="text-transform: uppercase; font-size: 70%;margin-left: -0.3em;vertical-align: 0.15em; line-height: 0;">a</span>muriyan内部のノード操作は基本的に「要素の作成」、「操作要素の変更」の二つの操作から成り立っています。例えば、\blockコマンドは実際には</p>
<ul>
<li>
<p>現在の操作ノードを保存</p>
</li>
<li>
<p>&yen;createElementによるDOMの作成と同時に、操作DOMを作成したDOMに変更</p>
</li>
<li>
<p>&yen;setAttrを用いてノードに属性を指定</p>
</li>
<li>
<p>DOMの中身を記述</p>
</li>
<li>
<p>操作DOMを1で保存したノードに変更</p>
</li>
</ul>
<p>という手順でノードの作成を行っています。これらネイティブなコマンドを利用すると簡単にノード操作を崩壊させれるため、一般ユーザーが使うことは非推奨です。上記のマクロでは対応できない場合に、細心の注意を払って利用してください。</p>
<section class="ssect" id="__section:029">
<header>
<h1><span class="secnumber">3-3.1</span>&yen;createElement</h1>
</header>
<p>&yen;createNode,&yen;createElement,&yen;insertElementは要素を作成するコマンドです。使い方は</p>
<code class="nhlight nhlight-TeX">
<pre><ol start="1"><li class="oddline"><span class="linecontainer"><span class="command-token">\createNode</span><span class="text-token">[i</span>&nbsp;<span class="text-token">or</span>&nbsp;<span class="text-token">b]</span><span class="block-token">{</span><span class="text-token">DOM名</span><span class="block-token">}</span></span></li><li class="evenline"><span class="linecontainer"><span class="command-token">\createElement</span><span class="text-token">[i</span>&nbsp;<span class="text-token">or</span>&nbsp;<span class="text-token">b]</span><span class="block-token">{</span><span class="text-token">DOM名</span><span class="block-token">}</span></span></li><li class="oddline"><span class="linecontainer"><span class="command-token">\insertElement</span><span class="text-token">[i</span>&nbsp;<span class="text-token">or</span>&nbsp;<span class="text-token">b]</span><span class="block-token">{</span><span class="text-token">DOM名</span><span class="block-token">}</span></span></li></ol></pre></code>
<p>です。基本的にはcreateElementだけで事足ります。</p>
<p>第一引数のオプションはインライン要素（i）かブロック要素（b）かを指定します。デフォルトではcreateNodeはインライン要素、他はブロック要素になります。</p>
<p>createNodeは要素を持たない要素を作成し、操作DOMを新規に作ったDOMに変更します。</p>
<p>createElementは子要素を持つ要素を作成し、操作DOMを新規に作ったDOMに変更します。</p>
<p>insertElementは子要素を持つ要素を作成し、操作DOMの変更はしません。</p>
<p>ここら辺はL<span style="text-transform: uppercase; font-size: 70%;margin-left: -0.3em;vertical-align: 0.15em; line-height: 0;">a</span>muriyanの機関部ですので、一番最初の頃に実装しました。<span style="color:red;">なので正直これらの使い分けとか全然nodamushi自身が出来てなかったりします。</span>もう覚えてないんすよ(´･д･`)　createNodeもinsertElementも一箇所でしか使ってないしね。</p>
</section>
<section class="ssect" id="__section:030">
<header>
<h1><span class="secnumber">3-3.2</span>ノードの保存と設定</h1>
</header>
<p>TODO</p>
</section>
<section class="ssect" id="__section:031">
<header>
<h1><span class="secnumber">3-3.3</span>ヒエラルキーの移動</h1>
</header>
<p>TODO</p>
</section>
</section>


</div>
</body></html>
